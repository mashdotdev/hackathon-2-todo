# Implementation Plan: Phase II Full-Stack Web Application

**Branch**: `002-phase2-web` | **Date**: 2025-12-25 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/002-phase2-web/spec.md`

## Summary

Transform Phase I console app into a full-stack web application with:
- **Frontend**: Next.js 16+ with App Router, TypeScript, Tailwind CSS
- **Backend**: FastAPI with SQLModel ORM
- **Database**: Neon Serverless PostgreSQL
- **Auth**: Better Auth with JWT tokens

Core features: User registration/login, task CRUD with user isolation.

## Technical Context

**Language/Version**: Python 3.13+ (backend), TypeScript 5.x (frontend)
**Primary Dependencies**: FastAPI, SQLModel, Next.js 16+, Better Auth, Tailwind CSS
**Storage**: Neon Serverless PostgreSQL
**Testing**: pytest (backend), Vitest (frontend)
**Target Platform**: Web browsers (Chrome, Firefox, Safari, Edge - latest 2 versions)
**Project Type**: Web application (frontend + backend separation)
**Performance Goals**: Task list loads in <2s, API responses <500ms p95
**Constraints**: Mobile-responsive (375px+), 50 concurrent users
**Scale/Scope**: MVP for single-user productivity, ~100 tasks per user

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Spec-Driven Development | PASS | Spec created, plan in progress |
| II. No Manual Coding | PASS | All code via Claude Code |
| III. Test-First Development | PASS | Tests planned for backend/frontend |
| IV. AI-Native Architecture | N/A | Phase III requirement |
| V. Cloud-Native Deployment | N/A | Phase IV requirement |
| VI. Progressive Enhancement | PASS | Phase II builds on Phase I patterns |
| VII. Security-First | PASS | JWT auth, input validation, CORS |
| VIII. Observability | PARTIAL | Health endpoints included |
| IX. Simplicity & YAGNI | PASS | MVP scope, no over-engineering |

**Gate Status**: PASS - No violations requiring justification.

## Project Structure

### Documentation (this feature)

```text
specs/002-phase2-web/
├── plan.md              # This file
├── research.md          # Technology decisions
├── data-model.md        # Entity definitions
├── quickstart.md        # Setup instructions
├── contracts/
│   └── openapi.yaml     # API specification
└── tasks.md             # Generated by /sp.tasks
```

### Source Code (repository root)

```text
backend/
├── src/
│   ├── api/
│   │   ├── routes/
│   │   │   ├── auth.py      # Registration, login, logout
│   │   │   └── tasks.py     # Task CRUD endpoints
│   │   └── deps.py          # Dependencies (auth, db)
│   ├── core/
│   │   ├── config.py        # Settings from env
│   │   └── security.py      # JWT utilities
│   ├── models/
│   │   ├── user.py          # User SQLModel
│   │   └── task.py          # Task SQLModel
│   ├── services/
│   │   ├── auth_service.py  # Auth business logic
│   │   └── task_service.py  # Task business logic
│   └── main.py              # FastAPI app entry
├── tests/
│   ├── unit/
│   │   ├── test_auth_service.py
│   │   └── test_task_service.py
│   └── integration/
│       ├── test_auth_api.py
│       └── test_tasks_api.py
├── alembic/                  # Database migrations
├── pyproject.toml
└── .env.example

frontend/
├── src/
│   ├── app/
│   │   ├── (auth)/
│   │   │   ├── login/
│   │   │   │   └── page.tsx
│   │   │   └── register/
│   │   │       └── page.tsx
│   │   ├── dashboard/
│   │   │   └── page.tsx
│   │   ├── layout.tsx
│   │   └── page.tsx
│   ├── components/
│   │   ├── TaskList.tsx
│   │   ├── TaskItem.tsx
│   │   ├── TaskForm.tsx
│   │   └── AuthForm.tsx
│   └── lib/
│       ├── api.ts           # API client
│       └── auth.ts          # Auth utilities
├── tests/
│   └── components/
│       └── TaskList.test.tsx
├── package.json
├── tailwind.config.ts
├── tsconfig.json
└── .env.example
```

**Structure Decision**: Web application pattern with `backend/` and `frontend/` directories. This aligns with Phase I structure (backend already exists) and prepares for Phase III+ additions.

## Complexity Tracking

> No violations requiring justification. All patterns are standard for the technology stack.

## Implementation Phases

### Phase 1: Backend Foundation
1. Upgrade backend to FastAPI structure
2. Add SQLModel models (User, Task)
3. Configure Neon PostgreSQL connection
4. Set up Alembic migrations
5. Implement auth endpoints
6. Implement task CRUD endpoints
7. Add JWT middleware

### Phase 2: Frontend Foundation
1. Initialize Next.js project with App Router
2. Configure Tailwind CSS
3. Create auth pages (login, register)
4. Create dashboard page
5. Implement API client
6. Add Better Auth integration

### Phase 3: Integration & Testing
1. Connect frontend to backend API
2. Add backend unit tests
3. Add backend integration tests
4. Add frontend component tests
5. End-to-end flow verification

## Key Decisions

| Decision | Choice | Rationale |
|----------|--------|-----------|
| ORM | SQLModel | Constitution requirement, FastAPI native |
| Database | Neon PostgreSQL | User decision, serverless scalability |
| Auth Library | Better Auth | Constitution requirement |
| Frontend Router | App Router | Constitution specifies Next.js 16+ |
| Styling | Tailwind CSS | Constitution requirement |
| State Management | React hooks | Simple scope, no Redux needed |
| API Pattern | REST | Simpler than GraphQL for CRUD |

## Risk Assessment

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Better Auth learning curve | Medium | Medium | Follow official docs, keep auth simple |
| Neon cold start latency | Low | Low | Use connection pooling |
| CORS configuration issues | Medium | Low | Test early, document in quickstart |

## Artifacts Generated

| Artifact | Path | Status |
|----------|------|--------|
| Research | `research.md` | Complete |
| Data Model | `data-model.md` | Complete |
| API Contract | `contracts/openapi.yaml` | Complete |
| Quickstart | `quickstart.md` | Complete |
| Tasks | `tasks.md` | Pending `/sp.tasks` |

## Next Steps

Run `/sp.tasks` to generate the detailed task breakdown for implementation.
