<!--
  SYNC IMPACT REPORT
  ==================
  Version change: 1.1.0 → 1.1.1 (PATCH - added Spanish language support)

  Previous Changes (v1.1.0):
    - Added Principles VII-IX (Security, Observability, Simplicity)
    - Added Bonus Features Strategy (+700 points)
    - Added Code Quality Standards, Submission Requirements, Platform Requirements

  This Version (v1.1.1):
    - Added Spanish as supported language alongside Urdu in Multi-language Support bonus
    - Updated examples with Spanish commands

  Templates Status:
    ✅ plan-template.md - Constitution Check aligns with principles
    ✅ spec-template.md - User stories and acceptance criteria align
    ✅ tasks-template.md - Phase-based structure matches progressive enhancement
    ✅ phr-template.prompt.md - Ready for use

  Deferred Items:
    - None
-->

# Evolution of Todo Constitution

> **Mission**: Master the Architecture of Intelligence by building a Todo application
> that evolves from a simple console app to a fully-featured, cloud-native AI chatbot
> deployed on Kubernetes—all through Spec-Driven Development.

## Core Principles

### I. Spec-Driven Development (NON-NEGOTIABLE)

All development MUST follow the Spec-Driven Development (SDD) workflow. No code
generation is permitted without a validated specification.

**Workflow**: Specify → Plan → Tasks → Implement

- Every feature MUST begin with a specification in `specs/<feature>/spec.md`
- Specifications MUST include user stories, acceptance criteria, and success metrics
- Implementation plans MUST be generated from specifications via `/sp.plan`
- Tasks MUST be generated from plans via `/sp.tasks`
- Claude Code MUST be used for all code generation
- Prompt History Records (PHR) MUST be created for every significant interaction
- All prompts, iterations, and refinements MUST be preserved for judge review

**Rationale**: SDD ensures alignment between requirements and implementation,
provides traceability, and enables AI agents to produce consistent, correct output.
Judges will review the process, prompts, and iterations.

### II. No Manual Coding (NON-NEGOTIABLE)

Code MUST NOT be written manually. All implementation MUST be generated by Claude
Code based on validated specifications.

- Developers act as "Product Architects" not "Syntax Writers"
- Specifications MUST be refined until Claude Code generates correct output
- Manual code edits are only permitted for:
  - Configuration files (e.g., `.env`, `pyproject.toml`)
  - Minor formatting fixes post-generation
- All code generation sessions MUST be documented in PHR records

**Rationale**: This constraint ensures mastery of AI-driven development and
produces higher-quality, specification-aligned code.

### III. Test-First Development

Testing follows the Red-Green-Refactor cycle where applicable.

- Tests SHOULD be written before implementation when explicitly requested
- Tests MUST fail before implementation begins (Red phase)
- Implementation MUST make tests pass (Green phase)
- Code SHOULD be refactored after tests pass (Refactor phase)
- Integration tests are required for:
  - API contract changes
  - Database schema changes
  - Inter-service communication
  - MCP tool implementations

**Rationale**: Test-first development catches defects early and ensures
specifications translate correctly to implementation.

### IV. AI-Native Architecture

The application MUST leverage AI-native patterns and tools throughout its
architecture.

- Chat interfaces MUST use OpenAI ChatKit for UI
- AI logic MUST use OpenAI Agents SDK
- Tool exposure MUST follow MCP (Model Context Protocol) standards
- MCP servers MUST expose stateless tools that interact with the database
- Conversation state MUST be persisted to database (stateless server design)
- Natural language commands MUST be supported for all CRUD operations

**MCP Tool Requirements**:
- Tools MUST include: `add_task`, `list_tasks`, `complete_task`, `delete_task`, `update_task`
- Each tool MUST accept `user_id` as a required parameter
- Tools MUST return structured JSON responses

**Natural Language Examples**:
| User Says | Agent Action |
|-----------|--------------|
| "Add a task to buy groceries" | `add_task(title="Buy groceries")` |
| "Show me all my tasks" | `list_tasks(status="all")` |
| "Mark task 3 as complete" | `complete_task(task_id=3)` |
| "What's pending?" | `list_tasks(status="pending")` |

**Rationale**: AI-native architecture enables natural language interfaces,
horizontal scaling, and modern agent-based development patterns.

### V. Cloud-Native Deployment

All deployments MUST follow cloud-native principles and use container
orchestration.

- Applications MUST be containerized using Docker
- Local development MUST use Minikube for Kubernetes testing
- Production deployment targets:
  - DigitalOcean Kubernetes (DOKS), OR
  - Azure Kubernetes Service (AKS), OR
  - Google Kubernetes Engine (GKE), OR
  - Oracle Kubernetes Engine (OKE - recommended for always-free tier)
- Helm charts MUST be used for deployment configuration
- AIOps tools SHOULD be used:
  - `kubectl-ai` for AI-assisted Kubernetes operations
  - `kagent` for advanced cluster analysis
  - Docker AI Agent (Gordon) for Docker operations
- Dapr MUST be used for distributed application runtime (Phase V):
  - Pub/Sub for event streaming
  - State management for conversation state
  - Service invocation for inter-service communication
  - Jobs API for scheduled reminders
  - Secrets management for credentials

**Rationale**: Cloud-native deployment ensures scalability, resilience, and
production-readiness while teaching modern DevOps practices.

### VI. Progressive Enhancement

Development MUST follow a phased approach, building complexity incrementally.

**Phase Progression**:
| Phase | Description | Points | Due Date |
|-------|-------------|--------|----------|
| I | In-memory Python console app | 100 | Dec 7, 2025 |
| II | Full-stack web app with persistence | 150 | Dec 14, 2025 |
| III | AI-powered chatbot with MCP | 200 | Dec 21, 2025 |
| IV | Local Kubernetes deployment | 250 | Jan 4, 2026 |
| V | Cloud deployment with event-driven architecture | 300 | Jan 18, 2026 |
| **TOTAL** | | **1000** | |

**Feature Levels**:
- **Basic** (Phases I-IV): Add, Delete, Update, View, Mark Complete
- **Intermediate** (Phase V): Priorities, Tags, Search, Filter, Sort
- **Advanced** (Phase V): Recurring Tasks, Due Dates, Reminders

**Event-Driven Architecture (Phase V)**:
- Kafka MUST be used for event streaming (Redpanda Cloud or Strimzi)
- Topics: `task-events`, `reminders`, `task-updates`
- Separate services for: Notification, Recurring Tasks, Audit

**Rationale**: Progressive enhancement teaches the evolution of software from
simple scripts to distributed systems while maintaining working software at
each phase.

### VII. Security-First

All code MUST follow security best practices to prevent common vulnerabilities.

**OWASP Top 10 Prevention**:
- Input validation on all user inputs (prevent injection attacks)
- Parameterized queries for all database operations (prevent SQL injection)
- Output encoding for frontend rendering (prevent XSS)
- JWT token validation on all API endpoints
- Rate limiting on authentication endpoints
- CORS configuration for API security

**Secrets Management**:
- Secrets MUST NOT be hardcoded in source code
- Use `.env` files for local development (added to `.gitignore`)
- Use Kubernetes Secrets or Dapr Secrets Store in production
- API keys, database credentials, and tokens MUST be environment variables

**Authentication & Authorization**:
- Better Auth with JWT for user authentication
- All API endpoints MUST verify JWT token
- User isolation: users can only access their own data
- Token expiry and refresh mechanisms required

**Rationale**: Security vulnerabilities can disqualify submissions and
demonstrate poor engineering practices to judges.

### VIII. Observability

All services MUST be observable through logging, metrics, and tracing.

**Logging Standards**:
- Structured JSON logging for all services
- Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
- Required log fields: timestamp, service, level, message, correlation_id
- Sensitive data MUST NOT appear in logs

**Metrics (Phase IV+)**:
- Application metrics: request count, latency, error rate
- System metrics: CPU, memory, disk usage
- Business metrics: tasks created, completed, deleted per user

**Tracing (Phase V)**:
- Distributed tracing across services
- Correlation IDs for request tracking
- Integration with Dapr observability

**Health Checks**:
- `/health` endpoint for liveness probe
- `/ready` endpoint for readiness probe
- Database connectivity verification

**Rationale**: Observability is critical for debugging, performance tuning,
and demonstrating production-readiness to judges.

### IX. Simplicity & YAGNI

Code MUST be as simple as possible while meeting requirements.

**Principles**:
- Start simple, add complexity only when needed
- YAGNI (You Aren't Gonna Need It) - don't build features speculatively
- Smallest viable diff - don't refactor unrelated code
- No premature optimization
- No over-engineering or unnecessary abstractions

**Code Standards**:
- Functions should do one thing well
- Prefer composition over inheritance
- Avoid deep nesting (max 3 levels)
- Clear, descriptive naming over comments
- Delete dead code - don't comment it out

**Rationale**: Simpler code is easier to understand, test, maintain, and
for Claude Code to generate correctly.

## Bonus Features Strategy

> **Total Available Bonus Points: +700**

These features differentiate exceptional submissions and demonstrate advanced
mastery of AI-driven development.

### Reusable Intelligence (+200 points)

Create and use reusable intelligence via Claude Code Subagents and Agent Skills.

**Requirements**:
- Create custom Claude Code subagents for specific tasks
- Develop reusable Agent Skills that can be shared
- Document the intelligence patterns in `specs/intelligence/`
- Skills MUST be invocable via `/skill-name` pattern

**Example Skills**:
- `/todo-crud` - Reusable CRUD operations skill
- `/k8s-deploy` - Kubernetes deployment automation
- `/test-gen` - Test generation from specifications

### Cloud-Native Blueprints (+200 points)

Create and use Cloud-Native Blueprints via Agent Skills for infrastructure automation.

**Requirements**:
- Spec-driven deployment blueprints
- Infrastructure as Code (IaC) templates generated from specs
- Helm chart generation from specifications
- Kubernetes manifest generation via Claude Code

**Blueprint Pattern**:
```
specs/infra/<service>/
├── spec.md          # Infrastructure requirements
├── blueprint.md     # Generated deployment blueprint
└── manifests/       # Generated K8s/Helm files
```

### Voice Commands (+200 points)

Add voice input capability for todo management commands.

**Requirements**:
- Speech-to-text integration (Web Speech API or similar)
- Voice command processing through existing MCP tools
- Support for all basic CRUD operations via voice
- Visual feedback during voice input

**Example Commands**:
- "Hey Todo, add buy milk to my list"
- "Hey Todo, what tasks do I have today?"
- "Hey Todo, mark grocery shopping as done"

### Multi-language Support (+100 points)

Support additional languages in the chatbot interface.

**Supported Languages**:
- **Urdu** - Right-to-left (RTL) text support required
- **Spanish** - Left-to-right, widely spoken

**Requirements**:
- Language detection and appropriate response
- RTL text support in UI for Urdu
- Natural language understanding for commands in each language
- Multilingual responses (English + detected language)

**Examples**:
- Urdu: "میری ٹاسکس دکھاؤ" → Agent shows tasks with Urdu response
- Spanish: "Muéstrame mis tareas" → Agent shows tasks with Spanish response
- Spanish: "Agregar tarea: comprar leche" → Agent adds task with Spanish confirmation

## Technology Stack Requirements

### Phase I: Console Application
| Layer | Technology |
|-------|------------|
| Runtime | Python 3.13+ |
| Package Manager | UV |
| AI Tools | Claude Code, Spec-Kit Plus |
| Testing | pytest |

### Phase II: Full-Stack Web Application
| Layer | Technology |
|-------|------------|
| Frontend | Next.js 16+ (App Router), TypeScript, Tailwind CSS |
| Backend | Python FastAPI |
| ORM | SQLModel |
| Database | Neon Serverless PostgreSQL |
| Authentication | Better Auth with JWT |
| Testing | pytest (backend), Jest/Vitest (frontend) |

### Phase III: AI Chatbot
| Layer | Technology |
|-------|------------|
| Chat UI | OpenAI ChatKit |
| AI Framework | OpenAI Agents SDK |
| Tool Protocol | Official MCP SDK |
| Database | Same as Phase II |

### Phase IV: Local Kubernetes
| Layer | Technology |
|-------|------------|
| Containerization | Docker (Docker Desktop) |
| Orchestration | Kubernetes (Minikube) |
| Package Manager | Helm Charts |
| AIOps | kubectl-ai, kagent, Docker AI (Gordon) |
| Monitoring | Prometheus, Grafana (optional) |

### Phase V: Cloud Deployment
| Layer | Technology |
|-------|------------|
| Cloud K8s | DigitalOcean DOKS / Azure AKS / GCP GKE / Oracle OKE |
| Event Streaming | Kafka (Redpanda Cloud or Strimzi) |
| Distributed Runtime | Dapr |
| CI/CD | GitHub Actions |
| Monitoring | Cloud-native monitoring (Datadog, CloudWatch, etc.) |

## Code Quality Standards

### Linting & Formatting

**Python (Backend)**:
- Formatter: `ruff format` or `black`
- Linter: `ruff` or `flake8`
- Type checking: `mypy` (strict mode)
- Import sorting: `isort`

**TypeScript (Frontend)**:
- Formatter: `prettier`
- Linter: `eslint` with Next.js config
- Type checking: TypeScript strict mode

### Pre-commit Hooks

All repositories SHOULD include pre-commit hooks for:
- Code formatting
- Linting
- Type checking
- Secrets scanning (detect-secrets)

### Code Review Checklist

Before submitting code:
- [ ] Passes all linting and formatting checks
- [ ] Type hints on all functions (Python)
- [ ] TypeScript strict mode passes (Frontend)
- [ ] No hardcoded secrets or credentials
- [ ] PHR created for the implementation session
- [ ] Tests pass (if applicable)

## Development Workflow

### Repository Structure (Monorepo)
```
hackathon-todo/
├── .specify/                    # Spec-Kit Plus configuration
│   ├── memory/constitution.md   # This file
│   └── templates/               # Spec templates
├── specs/                       # Feature specifications
│   ├── <feature>/
│   │   ├── spec.md
│   │   ├── plan.md
│   │   └── tasks.md
│   └── intelligence/            # Reusable intelligence specs (bonus)
├── history/                     # Development history
│   ├── prompts/                 # PHR records
│   │   ├── constitution/
│   │   ├── <feature>/
│   │   └── general/
│   └── adr/                     # Architecture Decision Records
├── frontend/                    # Next.js application
│   ├── CLAUDE.md
│   └── src/
├── backend/                     # FastAPI application
│   ├── CLAUDE.md
│   └── src/
├── infra/                       # Infrastructure (Phase IV+)
│   ├── docker/
│   ├── helm/
│   └── k8s/
├── CLAUDE.md                    # Root Claude Code instructions
├── AGENTS.md                    # Cross-agent instructions
└── README.md
```

### Workflow Commands
| Command | Purpose |
|---------|---------|
| `/sp.specify` | Create feature specification |
| `/sp.clarify` | Clarify underspecified areas |
| `/sp.plan` | Generate implementation plan |
| `/sp.tasks` | Break plan into actionable tasks |
| `/sp.implement` | Execute implementation tasks |
| `/sp.analyze` | Cross-artifact consistency check |
| `/sp.adr` | Document architectural decisions |
| `/sp.phr` | Create Prompt History Record |

### API Design Standards
- All endpoints under `/api/{user_id}/`
- RESTful conventions: GET (list/read), POST (create), PUT (update), DELETE (remove), PATCH (partial update)
- JWT authentication required on all endpoints
- JSON request/response format
- Proper HTTP status codes and error responses
- OpenAPI/Swagger documentation

### Database Conventions
- SQLModel for all database operations
- Migrations via Alembic or equivalent
- User isolation: all queries MUST filter by `user_id`
- Soft deletes preferred over hard deletes
- Indexes on frequently queried columns

## Platform Requirements

### Windows Users: WSL 2 (Required)

Windows users MUST use WSL 2 (Windows Subsystem for Linux) for development:

```bash
# Install WSL 2
wsl --install

# Set WSL 2 as default
wsl --set-default-version 2

# Install Ubuntu
wsl --install -d Ubuntu-22.04
```

### Development Environment

| Tool | Version | Purpose |
|------|---------|---------|
| Python | 3.13+ | Backend runtime |
| Node.js | 20+ LTS | Frontend runtime |
| UV | Latest | Python package manager |
| Docker Desktop | Latest | Containerization |
| Minikube | Latest | Local Kubernetes |
| kubectl | Latest | Kubernetes CLI |
| Helm | 3.x | Kubernetes package manager |

## Submission Requirements

### Required Deliverables (Per Phase)

| Deliverable | Description |
|-------------|-------------|
| GitHub Repository | Public repo with all source code |
| Deployed App | Vercel (frontend) + Backend API URL |
| Demo Video | Maximum 90 seconds (judges watch only first 90s) |
| WhatsApp Number | For presentation invitation |

### GitHub Repository Must Include

- [ ] `/specs` folder with all specification files
- [ ] `/history/prompts` folder with PHR records
- [ ] `CLAUDE.md` with Claude Code instructions
- [ ] `README.md` with comprehensive documentation
- [ ] Clear folder structure for each phase
- [ ] Working application code
- [ ] Environment setup instructions

### Demo Video Requirements

- Maximum 90 seconds duration
- Demonstrate all implemented features
- Show spec-driven development workflow
- Can use NotebookLM or screen recording
- Upload to YouTube/Loom and include link

### Submission Form

Submit at: https://forms.gle/KMKEKaFUD6ZX4UtY8

### Presentation Schedule

Live presentations on Zoom (8:00 PM):
- Phase I: Sunday, Dec 7, 2025
- Phase II: Sunday, Dec 14, 2025
- Phase III: Sunday, Dec 21, 2025
- Phase IV: Sunday, Jan 4, 2026
- Phase V: Sunday, Jan 18, 2026

Top submissions invited via WhatsApp to present live.

## Governance

### Amendment Procedure
1. Propose changes via PR to constitution file
2. Document rationale for changes
3. Obtain approval from project lead
4. Update dependent templates if affected
5. Increment version according to semantic versioning

### Versioning Policy
- **MAJOR**: Backward incompatible principle changes or removals
- **MINOR**: New principles/sections or material expansions
- **PATCH**: Clarifications, wording, typo fixes

### Compliance Requirements
- All PRs MUST verify compliance with constitution principles
- Complexity violations MUST be justified in plan.md
- PHR records MUST be created for all significant work
- ADR suggestions MUST be surfaced for architectural decisions

### Hierarchy of Authority
Constitution > Specification > Plan > Tasks

In case of conflict between artifacts, the higher-authority document prevails.

**Version**: 1.1.1 | **Ratified**: 2025-12-25 | **Last Amended**: 2025-12-25
